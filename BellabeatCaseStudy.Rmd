---
title: "How Can a Wellness Technology Company Play It Smart?"
author: "Ritik Sharma"
date: "05/09/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

![](bellabeatlogo.png) 

## Introduction 
This case study is a part of the Google Data Analytics Professional Certificate. It is an optional case study to demonstrate the new skills I have learned throughout the certificate. The primary focus of this case study is to follow the six steps of data analysis that were emphasized in this specialization. These steps include **Ask, Prepare, Process, Analyze, Share, Act**.

## STEP 1: ASK

### 1.1: Background Information

  Bellabeat is a high-tech manufacturer of health-focused focused products for women. Although a relatively small company, Bellabeat has the potential to become a larger player in the global smart device market. Bellabeat's mission is to empower women by providing them with the data to discover themselves. Their main priority is women's health. Bellabeat aspires to inspire women to be healthier, happier and more conscious.  
  
  Urška Sršen, the Chief Creative Officer and cofounder of Bellabeat believes that throught the analysis of smart device fitness data (FitBit in this case), Bellabeat could unlock new growth opportunities. 

### 1.2: Key Stake Holders

1. **Urška Sršen**: Bellabeat’s cofounder and Chief Creative Officer 
2. **Sando Mur**: Mathematician and Bellabeat’s cofounder; key member of the Bellabeat executive team
3. **Bellabeat marketing analytics team**: A team of data analysts responsible for collecting, analyzing, and
reporting data that helps guide Bellabeat’s marketing strategy

### 1.3: Business Task

Analyze smart device usage data in order to gain insight into how consumers use non-Bellabeat smart
devices. Select one Bellabeat product to apply these insights to in your presentation. 

### 1.4: Deliverables

1. A clear summary of the business task
2. A description of all data sources used
3. Documentation of any cleaning or manipulation of data
4. A summary of analysis
5. Supporting visualizations and key findings
6. Top high-level content recommendations based on the analysis performed

### 1.5: Key questions this report aims to answer

1. What are some trends in smart device usage?
2. How could these trends apply to Bellabeat customers?
3. How could these trends help influence Bellabeat marketing strategy?


## STEP 2: PREPARE

### 2.1: Information on the Dataset

1. This dataset was collected from Kaggle. It is made avaliable publicly by user 
Möbius, and can be found [here](https://www.kaggle.com/arashnic/fitbit). 
2. It was generated by respondents to a distributed survey via Amazon Mechanical Turk between 03-12-2016 and  05-12-2016.
3. It is stored in 18 CSV files. This data is in a long format. 
4. The respondents include 30 eligible FitBit users. The data includes minute-level output for physical activity, heart rate, and sleep monitoring.

### 2.2: Limitations of the Data

1. The sample size included in this data is 30. Data is available for 30 females using FitBit. This sample is not representative of the entire female population. Due to this, there might be bias in the dataset.
2. The data is from the year 2016. This data is not timely so it might not be relevant. There might have been major changes to lifestyle since 2016 considering a pandemic has been going on since 2020. 
3. This data is third-party data. It was collected on Amazon Mechanical Turk. 
4. The data is not cited.


## STEP 3: PROCESS

### 3.1: Setting up the project by loading relevant libraries

```{r}
library(tidyverse)
library(lubridate)
library(gtsummary)
library(gt)
library(glue)
library(gridExtra)
```

### 3.2: Loading CSV files as dataframes

Here, I will import CVS files into dataframes that will be used for this analysis. For this analysis, I would be using the "dailyActivity_merged.csv" and the "sleedDay_merged.csv" file. I chose to use this data because I want my analysis to focus on determining macro-level trends instead of focusing on the micro-level usage. I also wanted to analyze this sample's sleeping habits since that can have a big impact on the physical activities a person indulges in.  

```{r}
daily_activity <- read.csv("dailyActivity_merged.csv")
sleep_activity <- read.csv("sleepDay_merged.csv")
```

### 3.3: Data Cleaning

First, I would like to have a glimpse of the data I am working with. I noted that there are 15 columns and 940 rows in the daily activity dataframe. The columns include a unique identifier, activity date, total steps, total distance, tracker distance, distance covered categorized as very active, moderately active, light active, and sedentary active, active minutes categorized as very active, moderately active, light active and sedentary active, and calories. I also noted that total distance is the sum of the four categories of distance covered. The sleep activity dataframe had 5 columns and 413 rows. The columns include a unique identifier, date, total records for the person, minutes the person spent sleeping and minutes the person spent in bed.  

```{r}
glimpse(daily_activity)
glimpse(sleep_activity)
```

I want to make sure that all of the observations in my dataframe were unique and there were no null values. I confirmed all 940 observations in the daily activity dataframe were unique. There were also no null values in the dataframe. There were three duplicate observations in the sleep activity dataframe. These were removed. 
```{r, echo=TRUE, results='hide'}
unique(daily_activity)
na.omit(daily_activity)
sleep_activity <- unique(sleep_activity)
na.omit(sleep_activity)
```

As a next step, I wanted to confirm that there are 30 unique identifiers. After the check, I noted that there are 33 unique individuals that are a part of the daily activity dataset. There was sleep data for only 24 of the 33 individuals. Due to this, I will not merge the two datasets.
```{r}
length(unique(daily_activity$Id))
length(unique(sleep_activity$Id))
```

### 3.4: Data Manipulation 

First, I checked the type of each variable to make sure each object was the correct type. Upon inspection, I noticed that the "ActivityDate" variable in daily activity was not the correct type. It was of type character and had to be changed to a date object. Similary 
```{r}
# Class of ActivityDate before conversion
class(daily_activity$ActivityDate)
class(sleep_activity$SleepDay)

# Converting character to date
daily_activity1 <- daily_activity %>%
  mutate(ActivityDate = mdy(ActivityDate))

sleep_activity1<- sleep_activity %>%
  mutate(SleepDay = mdy_hms(SleepDay))

# Class of ActivityDate and SleepDay after conversion
class(daily_activity1$ActivityDate)
class(sleep_activity1$SleepDay)
```

I further wanted to split the "ActivityDate" variable from daily activity into its respective day and date(%d) components. This would allow me to analyze data depending on the day of the week. It would also be possible to analyze data according to the date in the current month cycle. Similarly, I found the respective day for the "SleepDay" variable in the daily sleep dataframe. 

```{r}
# Getting the day of the week for the respective date
daily_activity2 <- daily_activity1 %>%
  mutate(Day = weekdays(ActivityDate), 
         Date = format(ActivityDate, format = "%d"))

sleep_activity2 <- sleep_activity1 %>%
  mutate(Day = weekdays(SleepDay))
```

It was previously noted that total distance was the sum of very active distance, moderately active, and light active distances. Similar to this, I want to create a variable for total active hours which would be the sum of very active, fairly active, and light active minutes converted into hours. I also created two columns expressing the ratio of active hours to the total logged and the ratio of the sedentary hours to the total logged hours.

Note: I rounded the hours to zero decimal places while calculating total active hours and sedentary hours.

```{r}
daily_activity3 <- daily_activity2 %>%
  mutate(TotalActiveHours = round((VeryActiveMinutes + FairlyActiveMinutes + LightlyActiveMinutes)/60, digits = 0),
         SedentaryHours = round(SedentaryMinutes/60, digits = 0),
         TotalHours = SedentaryHours + TotalActiveHours,
         RatioActiveTotalHours = TotalActiveHours/TotalHours,
         RatioSedentaryHours= SedentaryHours/TotalHours,
         TotalMinutes = VeryActiveMinutes + FairlyActiveMinutes +LightlyActiveMinutes + SedentaryMinutes)
```


## STEP 4: ANALYZE

As a first step, I created a subset of the daily activity data to analyze meaningful metrics.
```{r}
daily_activity_summary <- daily_activity3 %>%
  select(TotalSteps, TotalDistance, VeryActiveDistance, ModeratelyActiveDistance, LightActiveDistance, VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes, SedentaryHours, Calories, TotalActiveHours, RatioActiveTotalHours, RatioSedentaryHours)

sleep_activity_summary <- sleep_activity2 %>%
  select(TotalMinutesAsleep, TotalTimeInBed)
```


Next, I created summary tables which are displayed below. 
```{r}
daily_activity_table_median <- tbl_summary(daily_activity_summary) %>%
  modify_caption("Table 1. Daily Activity Median and (1st Quartile, 3rd Quartile)")

daily_activity_table_mean <- tbl_summary(daily_activity_summary, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
  modify_caption("Table 2. Daily Activity Mean and Standard Deviation")

daily_activity_table_median
daily_activity_table_mean

```
### Findings from this analysis:

1. The average daily distance this sample of women covered was **`r round(mean(daily_activity_summary$TotalDistance), digits = 1)`**. 

2. The average steps taken by this sample was **`r round(mean(daily_activity_summary$TotalSteps), digits = 0)`**. This is lower than the the recommended amount of steps per day to see benefits from walking. The recommended average is 7000 steps per day according to a [large study](https://jamanetwork.com/journals/jamainternalmedicine/fullarticle/2734709) conducted in 2019. Both the average daily distance covered and the average daily steps were lower than the recommended values.

3. This sample was active for an average amount of 3 hours 46 minutes. This figure included activity logged into 3 categories. These categories included lightly active, fairly active, and very active. [Research](https://www.mayoclinic.org/healthy-lifestyle/fitness/expert-answers/exercise/faq-20057916) suggests that at least 30 minutes of moderate exercise should be met. But, if your primary goal is to lose weight or reach a specific fitness goal then you need do exercise for more than 30 minutes depending on your goal. According to this sample, these 33 women were logging an average of 35 minutes of fair to very active minutes. But, upon further inspection I noted that the median amount of fair to very active minutes logged was a staggering low value of 10 minutes per day. This was a more accurate representation of how much moderate exercise this sample of women were completing per day. This value was significantly lower than the recommended 30 minutes of moderate exercise per day.

4. This sample was sedentary for an average of 16 hours and 30 minutes. 

5. The average calories burned per day by this sample was **`r round(mean(daily_activity_summary$Calories), digits = 0)`**. The median calories burned per day by this sample was **`r round(median(daily_activity_summary$Calories), digits = 0)`**. 


```{r}
sleep_activity_table_mean <- tbl_summary(sleep_activity_summary, statistic = list(all_continuous() ~ "{mean} ({sd})")) %>%
  modify_caption("Table 3. Sleep Activity Mean and Standard Deviation")

sleep_activity_table_mean
```
### Findings from this analysis:

1. The average amount of time users spent sleeping was 417 minutes. This equates to 6 hours and 57 minutes of sleep. This is in line with the [recommended](https://www.cdc.gov/sleep/about_sleep/how_much_sleep.html) amount of sleep an adult should aim for. 
2. The average amount of time users spent in bed was 458 minutes. This equates to 7 hours and 38 minutes in bed. 


## STEP 5: SHARE

### 5.1: Relationship between the time a person spends in bed and the time a person sleeps for
```{r, warning=FALSE}
plot_time_bed_sleep <- ggplot(sleep_activity2, aes(x = sleep_activity2$TotalTimeInBed, y = sleep_activity2$TotalMinutesAsleep)) + geom_point() + geom_smooth(method = lm) + labs(title = "Relationship between time spent in bed and time spent asleep", x = "Time in Bed", y = "Time Asleep")

plot_time_bed_sleep
```

#### Key Insights
The time a person spends in bed and the time the person spends sleeping are positively related. We can see a strong linear relationship between these two variables. This is a good thing as most of the users are spending majority of their time in bed sleeping. This means most of the users in this sample have healthy sleeping habits it it does not take them long to fall asleep. Another thing to note is, there are a few outliers where the participants are spending somewhere between 1.5-2 times the time in bed as compared to the time they are actually sleeping. This should be addressed. 


### 5.2: Pie chart showing the distribution of activity type
```{r, warning=FALSE}
# Selecting relevant columns for the pie chart and renaming the column names
pie_select <- daily_activity3 %>%
  select(VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes, SedentaryMinutes) %>%
  rename(pie_very_active = VeryActiveMinutes, pie_fairly_active = FairlyActiveMinutes, pie_lightly_active = LightlyActiveMinutes, pie_sedentary_minutes = SedentaryMinutes)

# Changing dataframe from wide to long
pie <- pivot_longer(pie_select, cols = starts_with("pie")) %>%
  group_by(name) %>%
  summarise(freq = sum(value)) %>%
  mutate(rel_freq = freq / sum(freq), percent = rel_freq * 100)

# Plotting the pie chart
activity_frequency_piechart <- ggplot(pie, aes(x = "", y = percent, fill = as.factor(name))) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start = 0) + 
  scale_fill_manual(values = c("#008744","#0057e7","#d62d20","#ffa700"), "Activity",  labels = c("Fairly Active", "Lightly Active", "Sedentary", "Very Active")) + 
  theme(axis.text.x = element_blank()) +
  labs(title = "Activity Intensity Distribution", x = "", y = "")

activity_frequency_piechart
```

#### Key Insights
Majority of the activity minutes that have been registered on the app are sedentary minutes. Sedentary minutes consist of **`r round(pie$percent[3], digits = 2)`%** activity registered on the app. This is too much sedentary behavior and it can have drastic effects on an individual's health. There is [evidence](https://www.healthywa.wa.gov.au/Articles/S_T/Sedentary-behaviour#:~:text=2%2D5%20years%3A-,no%20more%20than%201%20hour%20at%20a%20time%20being%20sedentary,per%20day%20of%20screen%20time) suggesting that excessive sedentary behavior leads to health complications including but not limited to obesity, poor self-esteem, type-two diabetes, and injuries related to neck, back and shoulders. There was only **`r round(pie$percent[1] + pie$percent[4], digits = 2)`%** moderate to high intensive activity recorded on the app. This figure reaches the 30 minute moderate activity recommendation. But, if user have specific fitness goals, they need to be participating in more moderate to high intensity activity throughout their day.  more activity throughout the day should be promoted. Light activity consisted of **`r round(pie$percent[2], digits = 2)`%** of the activity recorded throughout the day.


### 5.3: Scatter plots showing relationship between total steps taken and calories burned & calories burned and very active minutes
```{r, warning=FALSE}
plot_active_hours_calories <- ggplot(daily_activity3, aes(x = daily_activity3$TotalSteps, y = daily_activity3$Calories)) + geom_point() + stat_smooth(method = lm) + labs(title = "Relationship between total steps taken and calories burned", x = "Total steps taken", y = "Calories burned")

plot_very_active_minutes_calories <- ggplot(daily_activity3, aes(x = daily_activity3$VeryActiveMinutes, y = daily_activity3$Calories)) + geom_point() + stat_smooth(method = lm) + labs(title = "Relationship between very active hours and calories burned", x = "Very Active Minutes", y = "Calories Burned")

grid.arrange(plot_active_hours_calories, plot_very_active_minutes_calories, nrow = 2)
```

#### Key Insights
There is a positive correlation between calories burned and the total steps. The more steps users took, the more calories they were able to burn. A positive linear relationship between calories burned and very active minutes is also established. These findings show the more active a person is and the greater number of steps a person takes results in more calories burning.  


### 5.4: Scatter plot showing relationship between the number of hours a person has recorded on the app and the amount of calories they burned    
```{r, warning=FALSE}
plot_very_active_minutes_distance <- ggplot(daily_activity3, aes(x = daily_activity3$TotalMinutes, y = daily_activity3$Calories)) + geom_point() + geom_smooth(method = lm) + labs(title = "Relationship between total minutes recorded on app and calories burned", x = "Total Minutes", y = "Calories Burned")

plot_very_active_minutes_distance
```

#### Key Insights
There is a weak relationship between the number of hours a person has recorded on the app and the amount of calories they burned that day. This indicates that using the regularly recording your activities on the app does not mean mean the person is actively burning more calories. This can largely be attributed to the excessive sedentary time people are recording. 


### 5.5: Bar graph showing how often the activity was logged on the app according to the day of the week.
```{r, warning=FALSE}
positions <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")

day_frequency_histogram <- ggplot(daily_activity3, aes(x = daily_activity3$Day)) + geom_bar(color = "#000000", fill = "#6096e7") + labs(title = "Activity logged by day", x = "Day", y = "Frequency", subtitle = "Sample of 30 women") + scale_x_discrete(limits = positions) + theme(axis.text.x = element_text(angle = 25))

day_frequency_histogram
```

#### Key Insights
The app is mostly being used during the week. This sample is most actively using the app on Tuesdays and the usage sees a continuous decline as the week progresses. There is a relatively big decline between Thursday and Friday and this trend continues until Monday.


## STEP 6: ACT

According to this analysis, there are several actions Bellabeat can take in order to improve and better market their products. In this section, the key question will be revisited and hopefully answered. 

This sample is primarily recording sedentary activity. Approximately **`r round(pie$percent[3], digits = 2)`%** of the activity recorded using FitBit's smart devices was sedentary. That is a big chunk of sedentary activity and is not a healthy trend. Bellabeat's primary focus should be to reduce the amount of sedentary time spent by its users. This challenge could be tackled in multiple ways. Bellabeat could utilize its app and send users timely notification around the hour mark to remind them to take a break and get some form of physical activity. Bellabeat's app could also recommend potential activities users can indulge in. The app should also let users set specific goals and start making recommendations to their lifestyles that are tailored to their goals.

Users were averaging `r mean(daily_activity_summary$TotalSteps)` daily steps. This is lower than the recommended 10,000 steps a day. The Bellabeat app should display a visual dashboard displaying the amount of steps the user has already completed and urge the user to complete 10,000 steps a day. 

In this data, people were mostly sleeping for majority of the time they spent in bed. This is a good thing. There were a few outliers who were only spending half the time in bed sleeping. Bellabeat should send alerts if the person is not spending enough time sleeping. The quality of sleep would improve the amount of moderate to intensive activity a person takes part in.   

Another common trend that was noticed was the reduction of recording activity as the week passes. There was significant decline on Friday, Saturday, and Sunday. One potential solution to address this problem would be to send users notifications on their phone if no activity has been recorded for more than one day. 

Bellabeat's marketing strategy should be to educate women on how to use the data provided to their benefit. Bellabeat already has a membership program which gives users 24/7 access to fully personalized guidance on nutrition, activity, sleep, health and beauty, and mindfulness based on their lifestyle and goals. The marketing team should focus on emphasizing the benefits users gain from using this membership. The company could offer a free trial period of the membership so customers can see if it really positively impacts them. 





